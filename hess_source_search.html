

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>H.E.S.S. Source Searches &mdash; pev-photons 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Galactic Plane" href="galactic_plane.html" />
    <link rel="prev" title="All-Sky Search" href="all_sky_search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pev-photons
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Set Up</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="all_sky_search.html">All-Sky Search</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">H.E.S.S. Source Searches</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#individual-source-tests">Individual Source Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stacking-test">Stacking Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#skymap-including-h-e-s-s-sources">Skymap including H.E.S.S. Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#individual-source-limit">Individual Source Limit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="galactic_plane.html">Galactic Plane</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance_checks.html">Performance Checks</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pev-photons</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>H.E.S.S. Source Searches</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/hess_source_search.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="h-e-s-s-source-searches">
<span id="hess-source-search"></span><h1>H.E.S.S. Source Searches<a class="headerlink" href="#h-e-s-s-source-searches" title="Permalink to this headline">¶</a></h1>
<p>Gamma-ray point sources observed by <a class="reference external" href="https://www.mpi-hd.mpg.de/hfm/HESS/">H.E.S.S.</a> at TeV energies are candidate targets for this analysis.  The scripts used to test for correlation with these sources are within the <code class="docutils literal notranslate"><span class="pre">pev-photons/TeVCat</span></code> directory.</p>
<div class="section" id="individual-source-tests">
<h2>Individual Source Tests<a class="headerlink" href="#individual-source-tests" title="Permalink to this headline">¶</a></h2>
<p>To fit each H.E.S.S. source location indiviually, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python individual_ts.py
</pre></div>
</div>
<p>This produces the file <code class="docutils literal notranslate"><span class="pre">{prefix}/TeVCat/hess_sources_fit_results.npy</span></code>, which stores the TS, <span class="math notranslate nohighlight">\(n_s\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> for each source location.  Convert these test statistics to pre-trial p-values with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python hess_ts_to_pvalue.py
</pre></div>
</div>
<p>Note that this requires the unique declination background trials produce in the <code class="docutils literal notranslate"><span class="pre">all_sky</span></code> section.  Add <code class="docutils literal notranslate"><span class="pre">--use_original_trials</span></code> to use the trials we generated instead.  Finally, to calculate the sensitivity to each H.E.S.S. source at 1 PeV, given an unbroken power law with the best fit spectral index from H.E.S.S. data, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python hess_sensitivities.py --ncpu *desired_ncpu*
</pre></div>
</div>
<p>Combining the information from this section should give you results consistent with the following table:</p>
<table border="1" class="colwidths-auto docutils" id="id1">
<caption><span class="caption-text">Individual H.E.S.S. Source Fit Results</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Source</th>
<th class="head"><span class="math notranslate nohighlight">\(\delta\)</span> [<span class="math notranslate nohighlight">\(^{\circ}\)</span>]</th>
<th class="head"><span class="math notranslate nohighlight">\(\alpha\)</span> [<span class="math notranslate nohighlight">\(^{\circ}\)</span>]</th>
<th class="head">pre-trial p-value</th>
<th class="head"><span class="math notranslate nohighlight">\(n_s\)</span></th>
<th class="head"><span class="math notranslate nohighlight">\(\gamma\)</span></th>
<th class="head">Sens. (x <span class="math notranslate nohighlight">\(10^{-20}\)</span>)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HESS J1356-645</td>
<td>-64.50</td>
<td>209.00</td>
<td>…</td>
<td>0.0</td>
<td>…</td>
<td>3.72</td>
</tr>
<tr class="row-odd"><td>HESS J1507-622</td>
<td>-62.35</td>
<td>226.72</td>
<td>0.29</td>
<td>2.5</td>
<td>1.3</td>
<td>4.75</td>
</tr>
<tr class="row-even"><td>SNR G292.2-00.5</td>
<td>-61.40</td>
<td>169.75</td>
<td>0.30</td>
<td>10.0</td>
<td>4.0</td>
<td>8.97</td>
</tr>
<tr class="row-odd"><td>Kookaburra (Rabbit)</td>
<td>-60.98</td>
<td>214.52</td>
<td>0.31</td>
<td>3.7</td>
<td>1.8</td>
<td>4.96</td>
</tr>
<tr class="row-even"><td>HESS J1458-608</td>
<td>-60.87</td>
<td>224.54</td>
<td>0.22</td>
<td>9.1</td>
<td>2.4</td>
<td>1.88</td>
</tr>
<tr class="row-odd"><td>HESS J1427-608</td>
<td>-60.85</td>
<td>216.97</td>
<td>0.07</td>
<td>25.9</td>
<td>3.2</td>
<td>12.10</td>
</tr>
<tr class="row-even"><td>Kookaburra (PWN)</td>
<td>-60.76</td>
<td>215.04</td>
<td>0.49</td>
<td>1.8</td>
<td>2.2</td>
<td>4.31</td>
</tr>
<tr class="row-odd"><td>SNR G318.2+00.1</td>
<td>-59.47</td>
<td>224.44</td>
<td>…</td>
<td>0.0</td>
<td>…</td>
<td>7.79</td>
</tr>
<tr class="row-even"><td>MSH 15-52</td>
<td>-59.16</td>
<td>228.53</td>
<td>0.52</td>
<td>1.6</td>
<td>3.8</td>
<td>14.97</td>
</tr>
<tr class="row-odd"><td>HESS J1018-589 B</td>
<td>-58.93</td>
<td>154.74</td>
<td>0.07</td>
<td>23.7</td>
<td>4.0</td>
<td>4.75</td>
</tr>
<tr class="row-even"><td>HESS J1018-589 A</td>
<td>-58.98</td>
<td>154.13</td>
<td>0.08</td>
<td>22.1</td>
<td>4.0</td>
<td>5.22</td>
</tr>
<tr class="row-odd"><td>HESS J1503-582</td>
<td>-58.23</td>
<td>225.91</td>
<td>0.17</td>
<td>21.9</td>
<td>4.0</td>
<td>12.73</td>
</tr>
<tr class="row-even"><td>HESS J1026-582</td>
<td>-58.20</td>
<td>156.66</td>
<td>0.09</td>
<td>26.7</td>
<td>4.0</td>
<td>2.50</td>
</tr>
<tr class="row-odd"><td>HESS J1026-582</td>
<td>-58.20</td>
<td>156.66</td>
<td>0.09</td>
<td>26.7</td>
<td>4.0</td>
<td>2.50</td>
</tr>
<tr class="row-even"><td>Westerlund 2</td>
<td>-57.79</td>
<td>155.85</td>
<td>0.08</td>
<td>32.0</td>
<td>4.0</td>
<td>9.35</td>
</tr>
<tr class="row-odd"><td>SNR G327.1-01.1</td>
<td>-55.08</td>
<td>238.65</td>
<td>…</td>
<td>0.0</td>
<td>…</td>
<td>14.30</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="stacking-test">
<h2>Stacking Test<a class="headerlink" href="#stacking-test" title="Permalink to this headline">¶</a></h2>
<p>Run the stacked likelihood test for all H.E.S.S. source combined by executing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python stacking_test.py
</pre></div>
</div>
<p>The results are stored in <code class="docutils literal notranslate"><span class="pre">{prefix}/TeVCat/stacking_fit_result.npy</span></code>. To generate background trials use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python stacking_test.py --bg_trials <span class="m">100000</span> --ncpu *desired_ncpu*
</pre></div>
</div>
<p>The results should match the following table:</p>
<table border="1" class="colwidths-auto docutils" id="id2">
<caption><span class="caption-text">H.E.S.S. Catalog Stacking Result</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Test Statistic</th>
<th class="head">p-value</th>
<th class="head"><span class="math notranslate nohighlight">\(n_s\)</span></th>
<th class="head"><span class="math notranslate nohighlight">\(\gamma\)</span></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1.74</td>
<td>0.08</td>
<td>65.23</td>
<td>3.66</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="skymap-including-h-e-s-s-sources">
<h2>Skymap including H.E.S.S. Sources<a class="headerlink" href="#skymap-including-h-e-s-s-sources" title="Permalink to this headline">¶</a></h2>
<p>To produce a plot of the all-sky scan p-value map with H.E.S.S. source positions overlaid run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python plot_HESS_region.py
</pre></div>
</div>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="_images/HESS_srcs_w_labels.png"><img alt="H.E.S.S. Source Skymap" src="_images/HESS_srcs_w_labels.png" style="width: 900.0px; height: 337.5px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 10</strong>:  All-sky likelihood scan pre-trial p-value shown in galactic coordinates. The H.E.S.S. sources in the analysis field of view are shown in black.</span></p>
</div>
</div>
<div class="section" id="individual-source-limit">
<h2>Individual Source Limit<a class="headerlink" href="#individual-source-limit" title="Permalink to this headline">¶</a></h2>
<p>Plot best fit spectrum of H.E.S.S. J1356-645 compared to the IceCube upper limit with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python plot_hess_sed.py
</pre></div>
</div>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="_images/hess_source_5.png"><img alt="H.E.S.S. J1356-645" src="_images/hess_source_5.png" style="width: 400.0px; height: 300.0px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 7 (right)</strong>: Measurements of the source H.E.S.S. J1356-645.  The best fit power law spectrum for the H.E.S.S. data is shown in blue.  The shaded region denotes statistical uncertainty, while the systematic uncertainty is represented by the dashed lines.  The 90% upper limit set by this analysis is shown in red.</span></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Zachary Griffith

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>